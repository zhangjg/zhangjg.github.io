---
title: R 語言學習(3)
layout: default

tags: [编程,读书]
---

# 列表和數據框架#
## 列表##
R語言中的*列表*對象是一個有序集合對象,其中的元素叫做這個列表的*成分(components)* .列表的
成分*不需要*類型或風格一樣.

```R
alist <- list(name1="hello",name2="world",name3=1:3);
print(alist[[1]]);#"hello"
print(alist[1]);
#$name1
#[1] "hello"
print(alist[["name1"]])# "hello"
print(alist$name1)# "hello"
```
[[]]操作符獲取的是一個列表的值的內容,而[]獲取的是元素的全部的內容,包含這個元素的各種屬性.
同時在[[]]和[]中還可以使用字符串來作為索引.像第5行那樣.因為列表的成分也是被命名的,所以,還
可以通過成分的名字直接來引用,像第5行那樣.

這裡因為"."是作為變量名的合法字符出現的,所以,不能用來做取分量的操作符.而"$"不能作為變量名
的有效字符,所以R中用他來作為取分量的操作符.還有一點需要注意的是,在R中,通過名稱引用一個變量
的時候只要不產生歧義,就可以使用最少的字符來應用,例如:

```R
list2 <- list(abbb="hello",accc="world",abbc=3:7);
print(list2$abbb);#"hello"
print(list2$ac);#"world"
```
因為list2中abbb和abbc兩個名字值差了一個字符,所以這兩個名字只能使用全面來引用,但是名字中
第二個字符為c的只有一個,所以accc在應用的時候,就可以只使用ac來應用.還嫌少注意的是,使用$來
引用成分的時候,不包含成分的名字,得到的結果和使用[[]]一樣.

如果在list()中,成分的名字被忽略的話,那麼成分將使用數字名字例如下面的代碼:

```R
listmix <- list(name="Tome",age=30,1:3)
# listmix$3 #error
listmix[[3]]
```
需要注意的是,因為數字不能做為變量的開頭的字符,所以也不能直接用在$操作符的後面,要引用匿名的
成分,只能使用[]或[[]]操作符.
## 數據框架##
*数据框架(data frame)* 是一個類型為"data.frame"的列表.對一個列表做一下的限制,可成為一個
數據框架:
+ 成分必須是是向量(數值,邏輯值,字符串),因子,數值矩陣,列表或其他的數據框架.
+ 矩陣,列表和數據框架提供的變量數目分別和他們有的行數,元素個數和變量數目相等.
+ 數值和邏輯向量以及因子被強制轉化為字符串,他們的leave是向量中的唯一值.
+ 作為數據框架出現的向量結構,必須有相同的長度,而矩陣必須有相同的行數.

數據框架很多情況下被認為是列的mode和屬性不同的矩陣.他一矩陣的形式出現,列和行就是用矩陣的
索引來轉化的.

當數據滿足數據框架的列上的要求的時候,可以使用data.frame()來構建數據框架.

# 從外部導入數據#
R對數據格式的要求比較苛刻,一般來說需要有如下的數據格式:行頭:表示沒一列數據的意義;數據項:
用空白隔開.
例如,如下的一個文本內容:

```text
Name Age Gender Income
Kite 20 W 100
Tom 32 M 130
```
通過read.table()函數可以讀入這樣的文件,例如:

```R
t <- read.table("test.data",header=TRUE)
# t is a list, have three lists components,the first was named Name,
# second named Age, and so on.
```
如果沒有文件頭,好可以使用scan() 函數來載入外部數據:

```R
t1 <- scan("test.data",list(Name="",Age=0,Gender="",Income=0));
```

參數中的list用來指定t1的結構.第一列是Name,字符串;第二列名字是Age數值;第三列是Gender:字
符串.

# R 語法簡介#
R語言是一個表達式語言.也就是說他的命令要麼是一個函數,要麼是一個返回值的表達式.即使是一個
賦值語句也是一個表達式,它的值是它賦值的值.
## 語句組##
命令可以通過大括號{}組合到一起,形成一個組.一個語句組的返回值是這個組最後一個語句的返回值.
## 控制語句##
### if語句###
if語句的格式為:

```R
if (exp_1) exp_2 else exp_3
```
當exp_1的值是一個邏輯值TRUE的時候,exp_2的值被返回,否者exp_3的返回值被返回.exp_2和exp_3
可以是一個語句組.exp_1可以是&& 或||連接的多個邏輯值.注意注意的是,對於單個邏輯值之間的邏輯
操作使用的是符號&&和||;而對於邏輯向量直接使用的是&和|.
和if else 語句對應的是ifelse()函數,它的格式如下:

```R
ifelse(commands,A,B);
```
如果comands[i] 的值是TRUE,返回A[i]的值,否者返回B[i]的值.這裡commands,A和B是等長的向量.
### 循環語句###
1. for
for 語句的格式為:
    ```R
    for( name in Vector) expr;
```
其中name是循環變量名; Vector 是一個向量表達式.而expr通常是一個表達式組.
但是for()語句在R中并不像它在其他語言中使用的那麼頻繁.
2. repeat expr
3. while(condition) expr

在repeate和while語句的expr一般也都是表達式組.

在循環語句中,可以使用break來終止循環的執行,而且break也是唯一解釋repeat循環的方法.使用
next來跳過本次循環.
reapte和while在R中效率比for更高,也更方便.
# 函數#
函數的定義是一個賦值語句:

```R
name <- function(arg_1,arg_2,...) expr
```
其中name是函數名,expr是R語言的表達式,通常是一個表達式組,expr使用參數arg_i,expr的計算結
果,就是函數的返回值.
函數的調用如下:

```R
name(parm1,parm2,...)
```
## 定義一個二元操作符##
二元操作符:`% anything %`可以通過對如下的方式來定義:
```R
 % ! % <- funtion (a,b) {...}
```

### 命名參數和默認參數###
R函數的所有參數都是命名參數,如果調用的時候給地參數的名字,那麼參數的位置可以亂序.但是調用的
時候如果沒有給定參數的名字,那麼按照函數定義的時候的參數順序對參數賦值.在函數定義的時候,還
可以為參數指定默認參數.默認參數的值可以是任意的表達式,而不只是常數,甚至可以是其他參數的組
成的表達式.

```R
a <- function (begin,end,length=end - begin) {...}
```
### ... 參數###
類似於其他語言的不定參數.可以直接把這個參數傳給其他的函數,也可以直接在其中引用每個不定參數
的內容例如:

```R
hello <- function (len,...){
    a<- c(...)
    print(a)
    sum <- 0
    print(..1)
    print(..2)
    print(..3)
}
hello(3,2,3,4)
```
### 返回值###
1. 函数执行的最后的一个语句的值就是函数的返回值。
2. 可以使用return(value)语句来显示的返回值value值。
3. 通过invisible(value)返回value值。

其中，第1,2种情况的返回的值，如果没有被赋给一个变量，就会打印到控制台。
第3中的返回值，如果没有赋值，不会打印出来，如果赋值给一个变量，
这个变量可以得到value的值。例如下面的代码：

```R
f1 <- function(a) {
    a+1
}
f2 <- function (a){
    #return a+1 ;#error
    return(a+1)
}
f3 <- function(a){
    invisible(a+1)
}
f1(2);# [1] 3
f2(2);# [1] 3
f3(2);# 控制台不输出。
r<-f3(2)
cat("f:",r,"\n",sep="") # f:3
```
