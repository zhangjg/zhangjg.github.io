---
title : R語言學習(1)
layout: default
tags  : [编程,读书]
---

# R語言簡介#
1. R是一個*表達式語言*
2. 大小寫敏感
3. 變量名
    * 可以用字母數字加'.'和'\_',[a-zA-Z0-9\\.\\+]
    * 變量名必須使用字母或者'.'開頭,如果使用'.'開頭,第二個字符不能是數字
    * 變量名的長度沒有限制
4. 基本的命令有表達式或賦值組成
    * 表達式作為命令的時候,計算其結果,打印出來(除非很特別不能顯示),然後就被丟棄了.
    * 不同的命令直接用分號(';')或新行分隔.
    * 基本的命令可以通過大括號('{'和'}')組合到一起.
    * 注釋為'#',行注釋

5. 執行文件

    ```R
source("commands.R")
    ```
執行當前目錄下的commands.R中的命令.

    ```R
sink("record.lis")
```
把所有的輸出序列從定向到外部的record.lis文件中.

    ```R
sink()
```
回到控制台中.

6. 對象

    R中創建和維護的所有的東西都是對象.包含:***變量*** , ***數值數組*** , ***字符串*** , ***函數***, 或其他的有這些構件組成的結構.objects()或ls()可以顯示一個會話中,幾乎所有對象的名字.當前存儲的對象的集合叫做 *工作空間(workspace)* .函數rm可以用來刪除對象:rm(x,y,z).

# 簡單維護:數值和向量#
R在命名的數據結構上做操作.最簡單的結構是 *向量* ,有序的數值集合.

```R
x <- c(1,2,3,4)
```
上面的代碼定義了一個變量x,並把c函數的結果複製給x.賦值在R中有多種表示方式,通用的操作符是'<-'大部分情況下等同於'=',還可以有右側賦值例如,下面的代碼完成了和上面的代碼一樣的功能:

```R
c(1,2,3,4) -> x
```
函數c()可以有任意數目的向量參數,它的結果是把他的所有的參數一個接一個的連接成一個新的向量.
這裡一個數值自身是一個表達式,作為長度為一的向量.

## 向量四則運算##
1. 向量可以在任意的表達式中使用,其中的元素被一個一個的執行.
2. 同一個表達式中的向量,元素個數可以不同.表達式的結果的長度是其中最長的向量的程度.在表達式中計算的時候,較短的向量會被循環使用.例如如下代碼:

    ```R
x=c(1,2)
y=c(3,4,5,6)
z=x+y
print(z)
```
結果是:
[1] 4,6,6,8
3. 基本的操作符有+,-,\*,/和^,分表表示加,減,乘,除和冪運算.
    + 函數:log,exp,sin,cos,tan,sqrt,...與通常的意義一樣.
    + max和min用來從向量中選出最大和最小值.
    + range(x) 返回一個長度為2的向量,第一個元素為x的最小值,第二個為x的最大值.
    + sum(x) 求x的所有元素的和:\\(\sum\_{i=1}^{n} x_{i}\\)
    + length(x) 求x中元素的格式
    + prod(x) 求x中所有元素的積:\\(\prod\_{i}^{n} x\_{i}\\).
    + mean(x) x的均值:sum(x)/length(x)
    + var(x) x的標準差,如果x是一個\\(n\times m\\)的矩陣,那麼var(x)的返回值是一個\\(m \times m\\)的協方差矩陣.
    + sort(x) 返回升序排列的向量.

## 產生規則的序列##
1. n:m
產生一個向量,元素為n到m.1:5和c(1,2,3,4,5)類似.冒號操作符的優先級更高,例如:2*1:15,是向量c(2,4,...,28,30).注意一下代碼的不同:

    ```R
n=10
a=1:n-1
b=1:(n-1)
print(a)#0,1,2,3,4,5,6,7,8,9
print(b)#1,2,3,4,5,6,7,8,9
```
當n>m的時候產生降序值,例如:

    ```R
5:1#5,4,3,2,1
```

2. seq(from=1,to=1,by=((to - from)/(length.out - 1)),length.out=NULL,along.with=NULL,...)

    seq()用來產生一個序列,從from開始,到to結束,每個元素公差為by,參數的序列的長度為length.out.例如:

    ```R
seq(0,1,length.out=11);#從0,到1,11個數字
seq(0,1,by=0.1);#同上
seq(1,9,by=2);#1,3,5,7,9
seq(by=3,1,9);#同上
```
R中的函數中的命名參數,調用的時候,可以不按位置來設置參數.函數可以設置默認值.

3. rep(x,...)
x為向量.
    1. req(x,times=1)
times是一個向量,如果times的長度為1,整體的把x重複times次.否者times的元素個數需要和x的相同,x的每個元素重複的次數有times的元素給定.
    2. req(x,each)....
x中每個元素重複each次,req(x,each=3)

## 索引向量:選取和修改一個數據的子集##
一個向量可以通過在向量後面的一個方括號中的 *索引向量* 來選取其中的元素,產生一個子集.例如:

```R
x=2*1:100;
index=10:11;#索引序列
y=x[index];#從x中按照index指定的下標,選取子集
print(y)# 20 22
```
可以作為索引向量的向量有一下四中類型:

1. 一個邏輯(boolean)向量
在這種情況下,索引向量會被循環成和被選擇的向量一樣的長度.與索引向量中的值為TRUE對應的值被選取,而那些與FALSE對應的值被忽略.例如:

    ```R
x[!is.na(x)]#選取x中所有的非NA,包含NAN的值
```
2. <a name="#正整數向量" >正整數向量</a>
這種情況下,索引序列必須在集合[1,2,...,length(x)]中.在索引序列中的元素作為下標,依序的從被選擇向量中選取元素.例如:

    ```R
x=1:100;
y=x[c(1,100,77,9)]
print(y)#1,100,77,9
```
3. 負整數向量
负整数向量用來指向被排除的元素.返回的子集合保持原來集合中的順序.例如:

    ```R
x=1:100;
y=x[0-c(1,100,77,9)]
print(y);#出了1,100,77,9之外的其他的元素
```
4. 字符串向量
如果一個對象有 *名字* 屬性的時候,可以使用字符串向量來做索引向量.用法和[正整數向量](#正整數向量)一樣.

    ```R
fruit <- c(5, 10, 1, 20)
names(fruit) <- c("orange", "banana", "apple", "peach")
print(fruit[c("apple","orange")])
```

索引向量還可以出現在賦值表達式中,只有索引表達式選中的值會被從新的賦值.例如:

```R
x[is.na(x)] <- 0 #x中原來為NA,NAN的值,被賦值為0.其他值不變
x[ x<0 ] <- -x[ x<0 ]# same as x <- abs(x)
```
